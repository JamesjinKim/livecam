# 분산 CCTV 시스템 확장 제안서

## 개요
현재의 단일 라즈베리파이 듀얼 카메라 시스템을 **3대의 라즈베리파이**와 **NAS 서버**를 연동한 분산 CCTV 시스템으로 확장

## 제안 시스템 구성

### 아키텍처 다이어그램
```
[Client Web] × 5 (동시 접속자)
        ↓
    [HUB/로드밸런서]
        ↓
    ┌───────┬───────┐
    ↓       ↓       ↓
[RPi5 #0]─[RPi5 #1]─[RPi5 #2]───[NAS 서버]
(2 카메라) (2 카메라) (2 카메라)  (저장/스트리밍)
```

### 구성 요소
| 구성요소 | 수량 | 역할 | 예상 비용 |
|----------|------|------|-----------|
| 라즈베리파이5 (8GB) | 3대 | 카메라 스트리밍 노드 | 30만원 |
| 카메라 모듈 (OV5647) | 6개 | 영상 입력 | 18만원 |
| NAS 서버 | 1대 | 중앙 저장/관리 | 50만원 |
| 기가비트 스위치 | 1개 | 네트워크 허브 | 5만원 |
| **총 예상 비용** | | | **103만원** |

## 핵심 기능

### 1. 분산 카메라 노드 (라즈베리파이)
- **총 6개 카메라**: 각 RPi당 2개 카메라 운영
- **독립 스트리밍**: 노드별 FastAPI 서버 (포트 8000-8002)
- **로컬 버퍼링**: 네트워크 장애 시 30분 로컬 저장
- **자동 동기화**: NAS 연결 복구 시 자동 업로드

### 2. 중앙 관리 시스템 (NAS)
- **통합 웹 인터페이스**: 모든 카메라 동시 모니터링
- **영상 저장**: H.264/H.265 압축, 30일 자동 순환
- **검색 기능**: 날짜/시간/카메라별 영상 검색
- **이벤트 감지**: 동작 감지 및 알림 (OpenCV 기반)

### 3. 로드밸런싱 & 페일오버
- **Nginx 리버스 프록시**: 클라이언트 요청 분산
- **자동 페일오버**: 노드 장애 시 자동 우회
- **상태 모니터링**: 전체 시스템 헬스체크 대시보드

## 구현 계획

### Phase 1: 기초 인프라 (2주)
- [x] 현재 시스템 분석
- [ ] 네트워크 토폴로지 설계
- [ ] 하드웨어 구매 및 설치
- [ ] 기본 OS 및 환경 설정

### Phase 2: 분산 시스템 구현 (3주)
- [ ] 노드별 스트리밍 서버 구축
- [ ] 노드 간 통신 프로토콜 구현
- [ ] NAS 연동 API 개발
- [ ] 자동 동기화 시스템

### Phase 3: 중앙 관리 시스템 (3주)
- [ ] 통합 웹 UI 개발
- [ ] 영상 저장/검색 시스템
- [ ] 이벤트 감지 알고리즘
- [ ] 사용자 권한 관리

### Phase 4: 최적화 및 안정화 (2주)
- [ ] 성능 튜닝
- [ ] 보안 강화
- [ ] 문서화
- [ ] 배포 및 모니터링

## 기대 효과

### 성능 향상
| 항목 | 현재 | 확장 후 | 개선율 |
|------|------|---------|--------|
| 카메라 수 | 2개 | 6개 | 300% |
| 동시 접속자 | 2명 | 10명+ | 500% |
| 저장 용량 | 32GB | 4TB+ | 12500% |
| 시스템 가용성 | 단일장애점 | 99.9% | N/A |

### 핵심 이점
1. **확장성**: 노드 추가로 쉽게 확장 가능
2. **안정성**: 단일 장애점 제거, 자동 페일오버
3. **성능**: 부하 분산으로 안정적인 스트리밍
4. **관리성**: 중앙화된 모니터링 및 제어

## 기술적 고려사항

### 네트워크 요구사항
- **대역폭**: 카메라당 5-10Mbps (720p 기준)
- **총 대역폭**: 30-60Mbps (6카메라 동시)
- **레이턴시**: <100ms (실시간 모니터링)

### 보안 고려사항
- **암호화**: HTTPS/TLS 1.3
- **인증**: JWT 토큰 기반
- **접근제어**: IP 화이트리스트
- **VPN**: WireGuard 터널링 (선택)

### 확장 가능성
- **최대 노드**: 10대까지 확장 가능
- **최대 카메라**: 20개까지 지원
- **AI 통합**: 향후 얼굴인식, 

차량번호 인식 추가 가능

## 예상 문제점 및 해결방안

### 1. 네트워크 병목
- **문제**: 다중 스트림 동시 전송 시 병목
- **해결**: 적응형 비트레이트, 캐싱 서버 도입

### 2. 동기화 이슈
- **문제**: 노드 간 시간 동기화
- **해결**: NTP 서버 구축, 타임스탬프 보정

### 3. 저장공간 관리
- **문제**: 대용량 영상 데이터 관리
- **해결**: 자동 압축, 순환 삭제, 클라우드 백업

## 투자 수익 분석

### 비용 대비 효과
- **초기 투자**: 약 103만원
- **월 운영비**: 전기료 약 2만원
- **상용 CCTV 대비**: 60-70% 비용 절감
- **ROI**: 12개월 내 회수 예상

## 결론

제안된 분산 CCTV 시스템은 현재의 단일 시스템 한계를 극복하고, 확장 가능하고 안정적인 엔터프라이즈급 감시 시스템을 구축할 수 있습니다. 오픈소스 기술과 라즈베리파이의 비용 효율성을 활용하여 상용 솔루션 대비 높은 가성비를 제공합니다.

## 다음 단계

1. **POC 구축**: 2대 RPi로 최소 구성 테스트
2. **성능 벤치마크**: 실제 환경 테스트
3. **상세 설계**: 네트워크 및 소프트웨어 아키텍처
4. **단계별 구현**: Phase별 순차 진행

---
**작성일**: 2025-09-19
**작성자**: SHT 프로젝트 팀