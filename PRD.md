# PRD (Product Requirements Document) - 산업용 CCTV 블랙박스 시스템

## 1. 제품 개요

### 1.1 제품명
**산업용 CCTV 블랙박스 시스템** (Industrial CCTV Blackbox System)

### 1.2 제품 설명
라즈베리파이 5 기반으로 첨단 디스플레이 산업의 생산공정 장비에 사용되는 영상 기록 시스템입니다. 24/7 연속 운영이 가능하며, 듀얼 카메라를 통한 전후방 동시 녹화를 지원합니다.

### 1.3 목표 시장
- **주요 고객**: 디스플레이 제조 공장
- **사용 환경**: 생산 라인, 품질 검사 구역, 장비 모니터링 구역
- **적용 분야**: OLED/LCD 생산 공정, 반도체 제조 공정, 정밀 기기 조립 라인

## 2. 비즈니스 목표

### 2.1 핵심 목표
- 생산 공정 중 발생하는 모든 이벤트의 영상 기록
- 품질 문제 발생 시 원인 추적을 위한 증거 자료 확보
- 장비 고장 및 사고 예방을 위한 실시간 모니터링

### 2.2 성공 지표 (KPI)
- **시스템 가동률**: 99.9% 이상 (연간 8.76시간 이하 중단)
- **영상 품질**: 640×480 이상 해상도, 30fps 안정적 유지
- **저장 효율**: 32GB 저장 공간에서 44시간 이상 녹화
- **응답 시간**: 영상 검색 및 재생 3초 이내

## 3. 기능 요구사항

### 3.1 필수 기능 (P0)

#### 3.1.1 영상 녹화
- ✅ 듀얼 카메라 동시 녹화 (전방/후방)
- ✅ 24/7 연속 녹화 지원
- ✅ 자동 파일 분할 (타임스탬프 기반)
- ✅ YUV420 포맷 실시간 저장

#### 3.1.2 성능 요구사항
- ✅ CPU 사용률 15% 이하 (640×480 단일 카메라)
- ✅ 30fps 안정적 유지
- ✅ 메모리 사용 최적화 (1GB 이하)

#### 3.1.3 안정성
- ✅ 자동 복구 시스템 (카메라 연결 해제 시)
- ✅ 전원 손실 시 데이터 보호 (flush 기능)
- ⏳ 순환 녹화 (디스크 풀 시 오래된 파일 자동 삭제)

### 3.2 우선순위 높음 (P1)

#### 3.2.1 모니터링
- ⏳ 웹 기반 실시간 영상 스트리밍
- ⏳ 시스템 상태 대시보드 (CPU, 메모리, 디스크)
- ⏳ 이벤트 알림 시스템

#### 3.2.2 영상 관리
- ✅ MP4 변환 지원 (후처리)
- ⏳ 영상 검색 기능 (날짜/시간 기반)
- ⏳ 영상 백업 기능

### 3.3 우선순위 중간 (P2)

#### 3.3.1 고급 기능
- ⏳ 모션 감지 기반 녹화
- ⏳ AI 기반 이상 감지
- ⏳ 다중 해상도 동시 지원

#### 3.3.2 통합
- ⏳ 외부 센서 연동 (온도, 습도, 진동)
- ⏳ MES/ERP 시스템 연동
- ⏳ 클라우드 백업

## 4. 기술 요구사항

### 4.1 하드웨어 사양

#### 최소 요구사항
- Raspberry Pi 5 (4GB RAM)
- OV5647 카메라 모듈 × 2
- 32GB microSD (Class 10)
- 5V/3A 전원 어댑터

#### 권장 요구사항
- Raspberry Pi 5 (8GB RAM)
- OV5647 카메라 모듈 × 2
- 128GB microSD (A2 등급)
- 5V/5A 전원 어댑터
- 방열판 및 쿨링 팬

### 4.2 소프트웨어 스택
- **OS**: Raspberry Pi OS (64-bit)
- **영상 캡처**: rpicam-vid
- **영상 포맷**: YUV420 (기본), MJPEG (옵션)
- **영상 변환**: FFmpeg
- **스크립트**: Bash
- **향후 개발**: Python (FastAPI), Node.js

### 4.3 성능 사양

| 구성 | CPU 사용률 | 메모리 사용 | 저장 용량/시간 |
|------|-----------|------------|--------------|
| 단일 640×480 | 5-8% | < 500MB | 720MB |
| 단일 1280×720 | 13-15% | < 800MB | 1.6GB |
| 듀얼 640×480 | 10-16% | < 1GB | 1.4GB |
| 듀얼 1280×720 | 25-30% | < 1.5GB | 3.2GB |

## 5. 비기능 요구사항

### 5.1 신뢰성
- **MTBF**: 10,000시간 이상
- **MTTR**: 30분 이내
- **데이터 무결성**: 99.99%

### 5.2 보안
- 로컬 저장 암호화 (옵션)
- 접근 권한 관리
- 영상 무단 삭제 방지

### 5.3 사용성
- 원클릭 시작/중지
- 직관적인 파일 명명 규칙
- 명확한 오류 메시지

### 5.4 유지보수성
- 모듈식 설계
- 상세한 로깅
- 원격 업데이트 지원

## 6. 제약사항

### 6.1 기술적 제약
- **H.264 하드웨어 인코딩 미지원**: 라즈베리파이 5의 하드웨어 제약
- **실시간 MP4 인코딩 불가**: CPU 100% 사용으로 인한 제약
- **최대 해상도**: 1920×1080 (성능 저하 발생)

### 6.2 환경적 제약
- **작동 온도**: 0°C ~ 50°C
- **습도**: 20% ~ 80% (비응축)
- **전원**: 안정적인 5V 공급 필수

## 7. 개발 로드맵

### Phase 1: MVP (완료 ✅)
- [x] 기본 녹화 기능
- [x] 듀얼 카메라 지원
- [x] YUV420 저장
- [x] 스크립트 기반 제어

### Phase 2: 안정화 (진행중 🔄)
- [ ] 순환 녹화
- [ ] 자동 복구 강화
- [ ] 성능 최적화
- [ ] 문서화

### Phase 3: 웹 인터페이스 (계획 📋)
- [ ] 실시간 스트리밍
- [ ] 원격 제어
- [ ] 영상 검색/재생
- [ ] 시스템 모니터링

### Phase 4: 고급 기능 (미래 🚀)
- [ ] AI 기반 분석
- [ ] 클라우드 연동
- [ ] 다중 시스템 통합
- [ ] 빅데이터 분석

## 8. 리스크 관리

### 8.1 기술적 리스크
| 리스크 | 영향도 | 발생확률 | 대응 방안 |
|--------|-------|---------|-----------|
| SD 카드 수명 | 높음 | 중간 | 산업용 SD 사용, 정기 교체 |
| 열 발생 | 중간 | 높음 | 쿨링 시스템 필수 |
| 전원 불안정 | 높음 | 낮음 | UPS 설치 권장 |

### 8.2 운영 리스크
- **데이터 손실**: 정기 백업 체계 구축
- **시스템 다운**: 이중화 시스템 구축
- **성능 저하**: 정기 유지보수 계획

## 9. 성공 기준

### 9.1 기술적 성공 기준
- ✅ 30fps 안정적 녹화
- ✅ CPU 사용률 목표 달성
- ✅ 24시간 연속 운영 검증
- ⏳ 99.9% 가동률 달성

### 9.2 비즈니스 성공 기준
- 생산 공정 문제 해결 시간 50% 단축
- 품질 이슈 추적 능력 향상
- 사고 예방을 통한 비용 절감

## 10. 부록

### 10.1 용어 정의
- **YUV420**: 색상 정보를 압축한 영상 포맷
- **rpicam-vid**: 라즈베리파이 공식 비디오 캡처 도구
- **MTBF**: Mean Time Between Failures (평균 고장 간격)
- **MTTR**: Mean Time To Repair (평균 복구 시간)

### 10.2 참고 문서
- [CLAUDE.md](./CLAUDE.md) - 개발자 기술 문서
- [README.md](./README.md) - 사용자 가이드
- [QUICK_START.md](./QUICK_START.md) - 빠른 시작 가이드

### 10.3 변경 이력
| 날짜 | 버전 | 변경 내용 | 작성자 |
|------|------|-----------|--------|
| 2024-12-30 | 1.0 | 초기 작성 | System |
| 2024-12-30 | 1.1 | 실제 구현 상태 반영 | System |

---
*이 문서는 산업용 CCTV 블랙박스 시스템의 제품 요구사항을 정의합니다.*